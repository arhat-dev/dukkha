tools:
  docker:
  # first tool in this kind will be the default tool
  - name: default-docker
    env:
    - DOCKER_BUILDKIT=0

docker:build:
- name: dukkha
  matrix@template_file: .dukkha/scripts/get-image-build-matrix.yml
  image_names@template_file: .dukkha/scripts/get-image-name.yml
  dockerfile@shell_file: .dukkha/scripts/get-dockerfile.sh
  # yamllint disable-line rule:quoted-strings
  build_context: "."
  extraArgs:
  - --pull
  - --build-arg="ARCH=${MATRIX_ARCH}"
  - --build-arg="TARGET=dukkha.${MATRIX_OS}.${MATRIX_ARCH}"
  - --build-arg="APP=dukkha"
  - --no-cache

docker:push:
- name: dukkha
  matrix@template_file: .dukkha/scripts/get-image-build-matrix.yml
  image_names@template_file: .dukkha/scripts/get-image-name.yml
